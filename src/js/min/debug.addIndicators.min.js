(function(e,m){"function"===typeof define&&define.amd?define(["ScrollMagic"],m):"object"===typeof exports?m(require("scrollmagic")):m(e.ScrollMagic||e.jQuery&&e.jQuery.ScrollMagic)})(this,function(e){var m=window.console||{},m=Function.prototype.bind.call(m.error||m.log||function(){},m);e||m("(debug.addIndicators) -> ERROR: The ScrollMagic main module could not be found. Please make sure it's loaded before this plugin or use an asynchronous loader like requirejs.");var d=e._util,v=0;e.Scene.extend(function(){var b=
this,c;b.addIndicators=function(a){c||(a=d.extend({},{name:"",indent:0,parent:void 0,colorStart:"green",colorEnd:"red",colorTrigger:"blue"},a),v++,c=new A(b,a),b.on("add.plugin_addIndicators",c.add),b.on("remove.plugin_addIndicators",c.remove),b.on("destroy.plugin_addIndicators",b.removeIndicators),b.controller()&&c.add());return b};b.removeIndicators=function(){c&&(c.remove(),this.off("*.plugin_addIndicators"),c=void 0);return b}});e.Controller.addOption("addIndicators",!1);e.Controller.extend(function(){var b=
this,c=b.info(),a=c.container,k=c.isDocument,q=c.vertical,n={groups:[]};b._indicators&&function(){b._log&&(Array.prototype.splice.call(arguments,1,0,"(debug.addIndicators)","->"),b._log.apply(this,arguments))}(2,"WARNING: Scene already has a property '_indicators', which will be overwritten by plugin.");this._indicators=n;var f=function(){n.updateBoundsPositions()},l=function(){n.updateTriggerGroupPositions()};a.addEventListener("resize",l);k||(window.addEventListener("resize",l),window.addEventListener("scroll",
l));a.addEventListener("resize",f);a.addEventListener("scroll",f);this._indicators.updateBoundsPositions=function(b){b=b?[d.extend({},b.triggerGroup,{members:[b]})]:n.groups;for(var c=b.length,k={},l=q?"left":"top",f=q?"width":"height",e=q?d.get.scrollLeft(a)+d.get.width(a)-15:d.get.scrollTop(a)+d.get.height(a)-15,p,g,r;c--;)for(r=b[c],p=r.members.length,g=d.get[f](r.element.firstChild);p--;)k[l]=e-g,d.css(r.members[p].bounds,k)};this._indicators.updateTriggerGroupPositions=function(c){c=c?[c]:n.groups;
for(var l=c.length,f=k?document.body:a,f=k?{top:0,left:0}:d.get.offset(f,!0),e=q?d.get.width(a)-15:d.get.height(a)-15,m=q?"width":"height",u=q?"Y":"X",p,g,r,t;l--;)p=c[l],g=p.element,r=p.triggerHook*b.info("size"),t=d.get[m](g.firstChild.firstChild),t=r>t?"translate"+u+"(-100%)":"",d.css(g,{top:f.top+(q?r:e-p.members[0].options.indent),left:f.left+(q?e-p.members[0].options.indent:r)}),d.css(g.firstChild.firstChild,{"-ms-transform":t,"-webkit-transform":t,transform:t})};this._indicators.updateTriggerGroupLabel=
function(b){var a="trigger"+(1<b.members.length?"":" "+b.members[0].options.name);b=b.element.firstChild.firstChild;b.textContent!==a&&(b.textContent=a,q&&n.updateBoundsPositions())};this.addScene=function(a){this._options.addIndicators&&a instanceof e.Scene&&a.controller()===b&&a.addIndicators();this.$super.addScene.apply(this,arguments)};this.destroy=function(){a.removeEventListener("resize",l);k||(window.removeEventListener("resize",l),window.removeEventListener("scroll",l));a.removeEventListener("resize",
f);a.removeEventListener("scroll",f);this.$super.destroy.apply(this,arguments)};return b});var A=function(b,c){var a=this,k=u.bounds(),e=u.start(c.colorStart),n=u.end(c.colorEnd),f=c.parent&&d.get.elements(c.parent)[0],l,h,m=function(){b._log&&(Array.prototype.splice.call(arguments,1,0,"(debug.addIndicators)","->"),b._log.apply(this,arguments))};c.name=c.name||v;e.firstChild.textContent+=" "+c.name;n.textContent+=" "+c.name;k.appendChild(e);k.appendChild(n);a.options=c;a.bounds=k;a.triggerGroup=void 0;
this.add=function(){h=b.controller();l=h.info("vertical");var c=h.info("isDocument");f||(f=c?document.body:h.info("container"));c||"static"!==d.css(f,"position")||d.css(f,{position:"relative"});b.on("change.plugin_addIndicators",x);b.on("shift.plugin_addIndicators",w);p();y();setTimeout(function(){h._indicators.updateBoundsPositions(a)},0);m(3,"added indicators")};this.remove=function(){if(a.triggerGroup){b.off("change.plugin_addIndicators",x);b.off("shift.plugin_addIndicators",w);if(1<a.triggerGroup.members.length){var c=
a.triggerGroup;c.members.splice(c.members.indexOf(a),1);h._indicators.updateTriggerGroupLabel(c);h._indicators.updateTriggerGroupPositions(c);a.triggerGroup=void 0}else z();k.parentNode.removeChild(k);m(3,"removed indicators")}};var w=function(){y()},x=function(b){"triggerHook"===b.what&&p()},y=function(){if(k.parentNode!==f){var a=h.info("vertical");d.css(e.firstChild,{"border-bottom-width":a?1:0,"border-right-width":a?0:1,bottom:a?-1:c.indent,right:a?c.indent:-1,padding:a?"0 8px":"2px 4px"});d.css(n,
{"border-top-width":a?1:0,"border-left-width":a?0:1,top:a?"100%":"",right:a?c.indent:"",bottom:a?"":c.indent,left:a?"":"100%",padding:a?"0 8px":"2px 4px"});f.appendChild(k)}a={};a[l?"top":"left"]=b.triggerPosition();a[l?"height":"width"]=b.duration();d.css(k,a);d.css(n,{display:0<b.duration()?"":"none"})},z=function(){h._indicators.groups.splice(h._indicators.groups.indexOf(a.triggerGroup),1);a.triggerGroup.element.parentNode.removeChild(a.triggerGroup.element);a.triggerGroup=void 0},p=function(){var g=
b.triggerHook();if(!(a.triggerGroup&&1E-4>Math.abs(a.triggerGroup.triggerHook-g))){for(var e=h._indicators.groups,f,k=e.length;k--;)if(f=e[k],1E-4>Math.abs(f.triggerHook-g)){a.triggerGroup&&(1===a.triggerGroup.members.length?z():(a.triggerGroup.members.splice(a.triggerGroup.members.indexOf(a),1),h._indicators.updateTriggerGroupLabel(a.triggerGroup),h._indicators.updateTriggerGroupPositions(a.triggerGroup)));f.members.push(a);a.triggerGroup=f;h._indicators.updateTriggerGroupLabel(f);return}if(a.triggerGroup){if(1===
a.triggerGroup.members.length){a.triggerGroup.triggerHook=g;h._indicators.updateTriggerGroupPositions(a.triggerGroup);return}a.triggerGroup.members.splice(a.triggerGroup.members.indexOf(a),1);h._indicators.updateTriggerGroupLabel(a.triggerGroup);h._indicators.updateTriggerGroupPositions(a.triggerGroup);a.triggerGroup=void 0}g=u.trigger(c.colorTrigger);e={};e[l?"right":"bottom"]=0;e[l?"border-top-width":"border-left-width"]=1;d.css(g.firstChild,e);d.css(g.firstChild.firstChild,{padding:l?"0 8px 3px 8px":
"3px 4px"});document.body.appendChild(g);g={triggerHook:b.triggerHook(),element:g,members:[a]};h._indicators.groups.push(g);a.triggerGroup=g;h._indicators.updateTriggerGroupLabel(g);h._indicators.updateTriggerGroupPositions(g)}}},u={start:function(b){var c=document.createElement("div");c.textContent="start";d.css(c,{position:"absolute",overflow:"visible","border-width":0,"border-style":"solid",color:b,"border-color":b});b=document.createElement("div");d.css(b,{position:"absolute",overflow:"visible",
width:0,height:0});b.appendChild(c);return b},end:function(b){var c=document.createElement("div");c.textContent="end";d.css(c,{position:"absolute",overflow:"visible","border-width":0,"border-style":"solid",color:b,"border-color":b});return c},bounds:function(){var b=document.createElement("div");d.css(b,{position:"absolute",overflow:"visible","white-space":"nowrap","pointer-events":"none","font-size":"0.85em"});b.style.zIndex="9999";return b},trigger:function(b){var c=document.createElement("div");
c.textContent="trigger";d.css(c,{position:"relative"});var a=document.createElement("div");d.css(a,{position:"absolute",overflow:"visible","border-width":0,"border-style":"solid",color:b,"border-color":b});a.appendChild(c);b=document.createElement("div");d.css(b,{position:"fixed",overflow:"visible","white-space":"nowrap","pointer-events":"none","font-size":"0.85em"});b.style.zIndex="9999";b.appendChild(a);return b}}});
